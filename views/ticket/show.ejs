<% layout('layouts/boilerplate.ejs') %>

<div class="container-fluid mt-5">
    <div class="row">
        <div class="col border-end"></div>
        <div class="col">
            <div class="row display-6 my-5">
                <div class="col ">Title: </div>
                <div class="col align-content-start"><%= tickDetail.title %></div>
                <div class="col "></div>
            </div>
            <div class="row display-6 text-start">
                
                <div class="col "></div>
            </div>
        </div>
        <div class="col border-start"></div>
        
    </div>
    <div class="row">
        <div class="col border-end"></div>
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="row mt-3 ">
                        <div class="col-sm-5">
                            <p>Owner: </p>
                        </div>
                        <div class="col-auto">
                            <% for(let owner of tickDetail.owners ) { %>
                                <p><%= owner.lastName %>, <%= owner.firstName %></p>
                            <% } %>
                        </div>
                    </div>
                    <div class="row my-1">
                        <div class="col-sm-5">
                            <p>Company: </p>
                        </div>
                        <div class="col">
                            <% for(let company of tickDetail.companies ) {%>
                                <p><%= company.companyName %></p>
                            <% } %>
                        </div>
                    </div>
                   
                </div>
                <div class="col">
                    <div class="row mt-3 ">
                        <div class="col-sm-5">
                            <p>Status: </p>
                        </div>
                        <div class="col"><%= tickDetail.ticketStatus %></div>
                    </div>
                    <div class="row my-1">
                        <div class="col-sm-5">Customer: </div>
                        <div class="col">
                            <% for(let customer of tickDetail.customers ) { %>
                                <p><%= customer.lastName %>, <%= customer.firstName %></p>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
           <div class="row mt-5">
            <div class="col"></div>
            <div class="col">
                <div class="card" style="width: 18rem;">
                    <div class="card-body">
                
                      <p class="card-text"><%= tickDetail.description %></p>
                      
                    </div>
                </div>
            </div>
            <div class="col"></div>
           </div>
           <div class="row">
            <div class="col">
                <% if(tickDetail.actions.length >= 1 ) {%>
                <div class="table-responsive">
                    <table class="table table-hover" style="max-height: 200px; overflow: auto;">
                        <thead>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Action</th>
                        </thead>
                        <tbody>
                            <% for(let action of tickDetail.actions ) { %>
                                <tr>
                                    <td><%= action.date %></td>
                                    <td><%= action.time %></td>
                                    <td><%= action.description%></td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <% } %>
            </div>
           </div>
           <div class="row mt-3 text-center">

            <div class="col ">
                <form class="form needs-validation" action="/tickets/edit/<%= tickDetail._id%>/addAction?_method=PUT" method="POST" novalidate>
                    <div class="row">
                        <div class="col text-end">
                            <label class="form-label" for="action" >Update: </label>
                        </div>
                        <div class="col">
                            <textarea class="form-control" id="action" name="action[description]" required></textarea>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col"> 
                            <button class="btn btn-info">Update</button>
                        </div>
                    </div>     
                </form>
            </div>
           </div>
           <div class="row mt-5 text-center">
            <div class="col">
                <form action="/tickets/edit/<%= tickDetail._id%>">
                    <button class="btn btn-success px-3">Edit ticket</button>
                </form>
            </div>
            <div class="col">
                
            </div>
            <div class="col">
                <form action="#">
                    <button class="btn btn-danger">Delete</button>
                </form>
            </div>
           </div>
        </div>
        
        <div class="col border-start">
           
        </div>
    </div>
</div>